{% extends "manager/layout.html" %}
{% load crispy_forms_tags %}
{% block form %}
    <div class="col-8">
        <div class="chartBox">
            <canvas id="myExpenseChart" width="300" height="175"></canvas>
            <input onchange="filterData()" type="date" id="startdate"> 
            <input onchange="filterData()" type="date" id="enddate"> 
        </div>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chart.js/dist/chart.umd.min.js"></script>
        {% comment %} <script type="text/javascript" src="../../static/manager/expenseGraph.js"></script> {% endcomment %}
        <script>
            // setup 
            const dates = {{ labels|safe }};
            const amount = {{ money|safe }};
            const data = {
                labels: dates,
                datasets: [{
                    label: 'Expense',
                    data: amount,
                    borderWidth: 1
                }]
            };
            
            // config 
            const config = {
                type: 'bar',
                data,
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            };
            
            // render init block
            const myChart = new Chart(
                document.getElementById('myExpenseChart'),
                config
            );
    
            function filterData(){
                const dates2 = [...dates];
                console.log(dates2);
                const startdate = document.getElementById('startdate')
                const enddate = document.getElementById('enddate')
                const indexstartdate = dates2.indexOf(startdate.value);
                const indexenddate = dates2.indexOf(enddate.value);
                console.log(indexstartdate)
                console.log(indexenddate)
                const filterDate = dates2.slice(dates2.indexOf(startdate.value), dates2.indexOf(enddate.value)+1);
                console.log(filterDate);
            }
    
        </script>                       
    </div>
    <div class="col-4">
        {% if messages %}
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} justify-content-center">
            {{ message }}
        </div>
        {% endfor %}
        {% endif %}
        <div class="data-section">
            <form method="post">
                {% csrf_token %}
                <fieldset class="form-group">
                    <legend class="border-bottom mb-4">Expense</legend>
                    {{ form|crispy }}
                </fieldset>
                <div class="form-group">
                    <button class="btn btn-outline-info" type="submit">Submit</button>
                </div>
            </form>
        </div>
    </div>
{% endblock form %}